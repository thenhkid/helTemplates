define(["jquery","bootstrap"],function(e){var t=e.fn.modal.Constructor,n=function(n,r){this.fileUrl=r.remote;if(this.fileUrl){var i=/^(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?(?=.*v=((\w|-){11}))(?:\S+)?$/,s=this.fileUrl.match(i)?RegExp.$1:!1;if(s){this.modalType="video";this.videoType="youtube";this.videoId=s;r.remote=!1}else{var o=["jpg","png","gif"],u=["pdf"];this.fileExtension=this.fileUrl.split(".").pop();if(e.inArray(this.fileExtension,o)>=0){this.modalType="image";r.remote=!1}else if(e.inArray(this.fileExtension,u)>=0){this.modalType="file";r.remote=!1}}}t.apply(this,arguments)};n.prototype=e.extend({},t.prototype,{constructor:n,_super:function(){var n=e.makeArray(arguments);t.prototype[n.shift()].apply(this,n)},sizeModal:function(t,n,r){var i=e(window).width(),s=e(window).height(),o=n/r,u,a=s-150,f=i-60;if(this.modalType==="image"){u=e(".modal-image",t);if(n>f)u.width(f);else if(r>a){u.height(a);u.width(a*o)}else{u.width(n);u.height(r)}}else if(this.modalType==="video"){u=e(".modal-video",t);u.width(n);u.height(r)}e(".modal-body",t).width(u.width());e(".modal-dialog",t).width(e(".modal-body",t).outerWidth())},resetMediaModal:function(t){e(".modal-body",t).html("").css({width:"",height:""});e(".modal-dialog",t).css("width","");e(t).removeClass("pdf-modal").removeClass("image-modal");t.removeData();t.off("shown.bs.modal")},show:function(){if(typeof this.modalType!="undefined"){var t=this,n=e(this.options.target),r="";e(".modal-header h3",n).text(this.options.title);if(this.modalType==="image"){var i=new Image;i.src=this.fileUrl;e(i).addClass("modal-image");i.onload=function(){e(".modal-body",n).get(0).appendChild(i);t.sizeModal(n,i.width,i.height);t._super("show")}}else if(this.modalType==="file"){if(this.fileExtension==="pdf"){r='<iframe src="" class="modal-iframe" height="100%" width="100%"></iframe>';n.addClass("pdf-modal");t._super("show");n.on("shown.bs.modal",function(){var i=e(".modal-content",n).outerHeight()-e(".modal-header",n).outerHeight();e(".modal-body",n).outerHeight(i).html(r);e(".modal-iframe",n).attr("src",t.fileUrl)})}}else if(this.modalType==="video"){t.videoType==="youtube"&&(r='<iframe width="560" height="315" class="modal-video" src="" frameborder="0" allowfullscreen></iframe>');n.addClass("video-modal");e(".modal-body",n).html(r);t.sizeModal(n,560,315);t._super("show");n.on("shown.bs.modal",function(){e(".modal-video",n).attr("src","//www.youtube.com/embed/"+t.videoId)})}n.on("hidden.bs.modal",function(){t.resetMediaModal(n)})}else this._super("show")}});e.fn.modal=function(r,i){return this.each(function(){var s=e(this),o=s.data("bs.modal"),u=e.extend({},t.DEFAULTS,s.data(),typeof r=="object"&&r);o||s.data("bs.modal",o=new n(this,u));typeof r=="string"?o[r](i):u.show&&o.show(i)})}});